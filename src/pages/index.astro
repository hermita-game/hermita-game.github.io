---
import Section from "../components/Section.astro";
import Layout from "../layouts/Layout.astro";
// Get images from public folder in images/tiles
const tiles = await Astro.glob("../../public/images/tiles/*.png");

// Get random boxes
const randomBoxes = tiles.map((img, i) => ({
  speed: (Math.random() > 0.5 ? 1 + Math.random() : -1 - Math.random())/10,
  url: img.default.replace("/public", ""),
  left: 5 + Math.random() * 75,
  animationDelay: Math.random()
}));
// shuffle array
randomBoxes.sort(() => Math.random() - 0.5);
---

<Layout calls="parallax, sections">
  <div class="bg-tiles not-transparent">
    {randomBoxes.map((img, i) => (
      <div class="tile" data-scroll-parallax={img.speed} style={{ marginLeft: `calc(${img.left}vw)` }}>
        <img src={img.url} alt="tile" style={{ animationDelay: `${img.animationDelay}s` }} />
      </div>
    ))}
  </div>
  <main>
    <div class="wrapper" data-scroll-section=".bg-tiles -> not-transparent">
      <div class="center">
        <h1 data-scroll-parallax={0.5}>Hermita</h1>
        <h2>By Epistars</h2>
      </div>
    </div>
    <div class="wrapper" id="fighting" data-scroll-section="#fighting -> highlight; .bg-tiles -> jumping">
      <Section title="Combat" imgURL="/design/spell.png">
        Le combat vous permettra de vous défouler et de vous amuser.
        Vous devrez combattre des monstres pour obtenir des ressources.
        Ces combats se font en coopération avec vos amis.
        Vous pourrez ainsi vous aider mutuellement pour vaincre les monstres les plus puissants.
      </Section>
    </div>
    <div class="wrapper" id="adventure" data-scroll-section="#adventure -> highlight; .bg-tiles -> flying">
      <Section title="Aventure" imgURL="/design/map.png">
        L'aventure est un point clé du jeu.
        Vous devrez explorer les différentes îles pour trouver des ressources et des monstres.
        Ces îles sont générées aléatoirement et vous pourrez ainsi découvrir de nouvelles choses à chaque fois.
        Vous pourrez également trouver des coffres cachés qui vous permettront d'obtenir des récompenses.
      </Section>
    </div>
    <div class="wrapper" id="crafting" data-scroll-section="#crafting -> highlight; .bg-tiles -> scaling">
      <Section title="Crafting" imgURL="/design/island.png">
        Si vous voulez améliorer votre équipement et vos compétences, vous devrez passer par le craft.
        Votre île personnelle sera votre lieu intime pour créer des objets.
        Vous pourrez y utiliser vos ressources dans les différents bâtiments qui vous seront débloqués.
        Cet espace est paisible et vous permettra de vous concentrer sur votre travail sans être dérangé que ce soit par des monstres ou des joueurs.
      </Section>
    </div>
  </main>
</Layout>

<style>
  @keyframes tile-jump {
    to {
      transform: translateY(30px);
    }
  }
  @keyframes tile-fly {
    25% {
      transform: translate3d(10px, -15px, 0);
    }
    50% {
      transform: translate3d(-2px, 10px, 0);
    }
    75% {
      transform: translate3d(5px, -5px, 0);
    }
  }
  @keyframes tile-scale {
	50% {
		transform: scale(0.7);
	}
  }
  .bg-tiles {
    width: 100%;
	  height: 100%;
    position: absolute;
    transition: opacity 500ms ease-in-out;
    z-index: -1;
	opacity: 0.3;
  }
  :global(.bg-tiles.not-transparent) {
    opacity: 1;
  }
  :global(.bg-tiles.jumping .tile img) {
    animation: tile-jump 300ms ease-in infinite alternate;
  }
  :global(.bg-tiles.flying .tile img) {
    animation: tile-fly 3s ease-in-out infinite;
  }
  :global(.bg-tiles.scaling .tile img) {
	animation: tile-scale 2s ease-in-out infinite;
  }

  main {
    width: 100%;
  }

  .wrapper {
    position: relative;
    min-height: 100vh;
	padding: 10rem 0;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  h1 {
    font-size: 5rem;
    font-weight: 900;
    margin-bottom: 0rem;
  }
  h2 {
    font-size: 3rem;
  }
  @media (max-width: 410px) {
    h1 {
      font-size: 3rem;
    }
    h2 {
      font-size: 2rem;
    }
  }

  .tile {
    width: 100px;
    height: 100px;
    margin-top: 10px;
  }

  .tile img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    image-rendering: pixelated;
  }
</style>
